<%- include('components/head'); -%>

  <body>

    <%- include('components/nav'); -%>
      <div id="generatebtn" >

      <div class="container bg-light mt-4  pt-2 pb-2 ">
        <div class="row">
          <div class="col-md-6">
            <h3>EVENT-DETAILS</h3>
          </div>
          <div class="col-md-4"></div>
          <div class="col-md-2 "><button type="submit" id="gc" class="btn btn-primary  ">Generate Chalan</button></div>
        </div>

        <hr>
        <div style="overflow-y: scroll; max-height: 70vh;">
        <!-- <button type="button" class="btn btn-primary w-100 ">Generate Chalan</button> -->
        <div class="row">
          <div class="col-md-8">
          
        

          <% if (data.CameraName) { %>
            <p> <b>Camera Name</b> : <%= data.CameraName %>
            </p>
            <% } %>
              <% if (data.timestamp) { %>
                <p> <b>Timestamp </b>: <%= data.timestamp %>
                </p>
                <% } %>
                  <% if (data.location) { %>
                    <p><b>Location </b>: <%= data.location %>
                    </p>
                    <% } %>
                      <% if (data.isSpeeding) { %>
                        <p> <b> isSpeeding: </b>
                          <%= data.isSpeeding %>
                        </p>
                        <% } %>

                          <% if (data.isANPR) { %>
                            <p> <b>isANPR </b> : <%= data.isANPR %>
                            </p>
                            <% } %>

                              <% if (data.isRLVD) { %>
                                <p> <b>isRLVD</b> : <%= data.isRLVD %>
                                </p>
                                <% } %>

                                  <% if (data.isTripleRiding) { %>
                                    <p> <b>isTripleRiding</b> : <%= data.isTripleRiding %>
                                    </p>
                                    <% } %>

                                      <% if (data.isNoHelmet) { %>
                                        <p> <b>isNoHelmet</b> : <%= data.isNoHelmet %>
                                        </p>
                                        <% } %>

                                          <% if (data.isWrongWay) { %>
                                            <p><b>isWrongWay </b> : <%= data.isWrongWay %>
                                            </p>
                                            <% } %>

                                              <% if (data.Speed) { %>
                                                <p><b> Speed </b> : <%= data.Speed %>
                                                </p>
                                                <% } %>
                                                <% if (data.LPNumber) { %>
                                                  <p> <b>LPNumber</b> : <%= data.LPNumber %>
                                                  </p>
                                                  <% } %>
                                                  <!-- <div class="col-md-3">
                                                    <button type="submit" class="btn  btn-primary w-100 "
                                                      value="Submit">Generate challan
                                                    </button>
                                                  </div> -->
                                                  <!-- </div> -->


                                                 
        </div>
       
        <div class="col-md-4">
          <% if (data.LPImagePath) { %>

            <p class="text-center w-100"><img
                src="<%= data.LPImagePath %>" width="100%"
                alt="imageNA">
            </p>
            <% } %>
        </div>
        
        <div class="col-md-6">
          <% if (data.RLVDImagePath) { %>

            <p class="text-center w-100"><img
                src="<%= data.RLVDImagePath %>" width="100%"
                alt="imageNA"></p>
            <% } %>
        </div>
        <div class="col-md-6">
          <% if (data.Snapshotpath) { %>

            <p class="text-center w-100"><img
                src="<%= data.Snapshotpath %>" width="100%"
                alt="imageNA"></p>
            <% } %>
        </div>
      </div>

                                                      <!-- <table class="table ">
                                                        <tr>
                                                          <td>

                                                            <% if (data.Snapshotpath) { %>

                                                              <p class="text-center w-100"><img
                                                                  src="<%= data.Snapshotpath %>" width="400px"
                                                                  alt="imageNA"></p>
                                                              <% } %>
                                                          </td>
                                                          <td rowspan="3">
                                                            <% if(data.VideoPath) { %>
                                                              <p class="w-100 px-5 "></p>
                                                              <video width="100%" alt="NA" controls autoplay muted>
                                                                <source src="<%= data.VideoPath %>" type="video/mp4">
                                                              </video>
                                                              </p>
                                                              <% } %>
                                                          </td>
                                                        </tr>
                                                        <tr>
                                                          <td>
                                                            <% if (data.LPImagePath) { %>

                                                              <p class="text-center w-100"><img
                                                                  src="<%= data.LPImagePath %>" width="400px"
                                                                  alt="imageNA">
                                                              </p>
                                                              <% } %>
                                                          </td>
                                                        </tr>

                                                        <tr>
                                                          <td>
                                                            <% if (data.RLVDImagePath) { %>

                                                              <p class="text-center w-100"><img
                                                                  src="<%= data.RLVDImagePath %>" width="400px"
                                                                  alt="imageNA"></p>
                                                              <% } %>
                                                          </td>
                                                        </tr>

                                                      </table> -->

        </div>

      <!-- </div>-->
    </div> 
      </div>

<div id="activity">
  Hello
  
</div>
      <div class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-delay="4101"
        style="position: absolute; top: 0; right: 0;">
        <div class="toast-header">
          <strong class="mr-auto">Success</strong>
          <button type="submit" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="toast-body">
          Data for Chalan generated Sucessfully
        </div>
      </div>

      <%- include('components/scripts'); -%>


        <!-- <script>
          const button1 = document.querySelector('#gc');
          const toast = $('.toast');
          button1.addEventListener("click", () => {
            event.preventDefault();
            toast.toast('show');
          })
        </script> -->
  </body>


  <script>
    const toast = $('.toast');
    loggedIN = localStorage.getItem('ISLOGGEDIN')
    if (loggedIN != 'true') {
      window.location.href = '/login';

    }
    const generateBtn = document.getElementById('#generatebtn');
    //  const apiResponseTable = document.getElementById("api-response");

    generateBtn.addEventListener('submit', (event) => {
      // event.preventDefault();

      // const analytics = apiForm.elements["analytics"].value;
      // const cameraName = apiForm.elements["camera-name"].value;
      // const fromDate = apiForm.elements["from-date"].value;
      // const toDate = apiForm.elements["to-date"].value;

      const url = 'http://localhost:4101/generate/challan/<%= data._id %>';

      fetch(url)
        .then((res) => res.json())
         .then((res) => {
          const textNode = document.querySelector('#activity');
                textNode.textContent = res.activity;
        //    const tableBody = apiResponseTable.querySelector("tbody");
        //    const header_row = document.createElement("tr");
        //    header_row.innerHTML = "<th>timestamp</th>"+
        //  "<th>Challan No</th>"+
        //  "<th>Camera Name</th>"+
        //  "<th> LPNumber</th>" +
        //  "<th> Status</th>" +
        //  "<th> lpImage</th>"
        //    tableBody.append(header_row)


        //    data.forEach(rowData => {
        //      const row = document.createElement("tr");
        //     /* Object.values(rowData).forEach(value => {
        //        const cell = document.createElement("td");
        //        console.log(value)
        //        cell.textContent = value;
        //        row.appendChild(cell);
        //      }); */


        //      row.innerHTML = 
        //                      "<td>" +"<a href='/search/detail/"+rowData._id+"' target='_blank'>"+rowData.timestamp  +"</a>"+"</td>"+
        //                       "<td>"+rowData.ChallanNo +"</td>" +
        //                         "<td>"+rowData.CameraName +"</td>" +
        //                         "<td>"+rowData.Status +"</td>" +
        //                           "<td>"+rowData.LPNumber +"</td>" +

        //                             "<td>"+"<img src='"+rowData.LPImageURL+"' alt='image' width='250px' >" +"</td>"

        //      tableBody.appendChild(row);
        //    });
         })
        .catch(error => console.error(error));
    });
  </script>


  </html>