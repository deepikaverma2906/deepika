
<%- include('components/head'); -%>
  <style>
    table {
      border-collapse: collapse;
      width: 100%;
    }

    th, td {
      padding: 8px;
      text-align: left;
      border-bottom: 1px solid #ddd;
   
    }
    td {
      background-color: #f2f2f2;
      color: #000;
    }
    tr th {
      background-color: #000;
      color: #f2f2f2;
    }
  </style>
 
<body>
  

 <%- include('components/nav'); -%>


 <div class="container mt-4">
   

     


  <form id="api-form">
   <div class="form-group">

      <div class="row">
         <div class="col-md-3">

<label for="analytics">Analytics:</label>
    <input type="text"   class="form-control" id="analytics" name="analytics">
         </div>
 
      <div class="col-md-3">
 <label for="camera-name">Camera Name:</label>
    <input type="text"   class="form-control" id="camera-name" name="camera-name">
      </div>
      <div class="col-md-3">
          <label for="from-date">From Date:</label>
    <input type="datetime-local" class="form-control" id="from-date" name="from-date" required>
      </div>
      <div class="col-md-3">
         
         
    <label for="to-date">To Date:</label>
    <input type="datetime-local"  class="form-control" id="to-date" name="to-date" required>
      </div>
   
      </div>
      <div class="row my-4">

 <div class="col-md-3">

      </div>
      <div class="col-md-3"></div>
      <div class="col-md-3"></div>
      <div class="col-md-3">
          <button type="submit" class="btn  btn-primary w-100 " value="Submit"> Search
      </button>
      </div> 
      </div>
     

   

   </div>
  
  </form>

  <table id="api-response">
    <thead>
      <tr>
        <th>id</th>
        <th>timestamp</th>
        <th>Analytics Name</th>
        <th>Camera Name</th>
        <th>Customer Name</th>
        <th> location</th>
        <th> imageurl</th>

      </tr>
    </thead>
    <tbody>
    </tbody>
  </table>


  

  <script>
   const toast = $('.toast');
   loggedIN=localStorage.getItem('ISLOGGEDIN')
  if (loggedIN!='true'){
    window.location.href = '/login';
    
  }
    const apiForm = document.getElementById("api-form");
    const apiResponseTable = document.getElementById("api-response");

    apiForm.addEventListener("submit", (event) => {
      event.preventDefault();

      const analytics = apiForm.elements["analytics"].value;
      const cameraName = apiForm.elements["camera-name"].value;
      const fromDate = apiForm.elements["from-date"].value;
      const toDate = apiForm.elements["to-date"].value;

      const url = `/api/v1/analytics/logs?analytics=${analytics}&cameraname=${cameraName}&from_date=${fromDate}&to_date=${toDate}`;

      fetch(url)
        .then(response => response.json())
        .then(data => {
          const tableBody = apiResponseTable.querySelector("tbody");
          tableBody.innerHTML = "";
          

          data.forEach(rowData => {
            const row = document.createElement("tr");
            Object.values(rowData).forEach(value => {
              const cell = document.createElement("td");
              cell.textContent = value;
              row.appendChild(cell);
            });
            tableBody.appendChild(row);
          });
        })
        .catch(error => console.error(error));
    });
  </script>
      

 </div>





 <%- include('components/scripts'); -%>
  </body>

</html>